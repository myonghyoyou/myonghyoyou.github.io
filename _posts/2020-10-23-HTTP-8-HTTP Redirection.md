---
title: HTTP (8) HTTP Redirection
tags: HTTP
article_header:
  type: cover
  image: 
      src: 
---

### 개요

리다이렉트란 말 그대로 re(다시) + 지시하다(direct) 다시 지시하는 것이다.

예를 들어 브라우저가 `www.test.com/page1` URL을 웹 서버에 요청했다. 
서버는 HTTP 응답 메시지를 통해 `www.test.com/page2`에 대한 Redirect Message를 보내며 브라우저에게 다른 URL(길, 방향) 을 지시한다.

---

### 원리

HTTP Redirection은 서버가 응답으로 리다이렉트 관련 요소를 보내며 이루어진다. `Redirect`가 포함된 응답은 `3`으로 시작하는 상태코드를 가지며,
리다이렉트할 URL을 담은 `Location` 헤더를 포함한다.

리다이렉트 응답을 받은 브라우저는 `Location` 헤더에 명시된 URL을 즉시 불러온다. 리다이렉트가 이뤄지는 데는 사용자가 알아차리기 힘들 정도로 자원 소모가 적다.

리다이렉트에는 아래와 같이 3가지 종류가 존재한다.
1. 영구적 리다이렉션
2. 일시적 리다이렉션
3. 특수 리다이렉션

#### `영구적 리다이렉션`

영구적으로 지속되는 리다이렉션을 의미한다. 기존의 URL이 사라지고 리다이렉트된 새로운 URL로 교체된다. 

검색 엔진, RSS 리더 및 다른 크롤러들은 기존의 URL을 리소스로 업데이트한다.

|코드|텍스트|메서드|주로 사용되는 곳|
|---|---|---|---|
|301|`Moved Permanently`|`GET` 메서드는 변경되지 않는다. 다른 메서드들은 `GET`으로 변할 수도 있다.|웹 사이트의 재구성|
|308|`Permanent Redirect`|메소드와 body는 변하지 않음.|GET이 아닌 링크나 동작을 지난 웹 사이트의 재편성|

`308` 응답에서는 메서드 변경을 허용할 의도가 없으나, 사실 상 브라우저가 그러한 방식으로 작동한다. 
`308` 은 GET이 아닌 메서드를 사용할 때 동작의 애매모호함을 제거하고자 만들어졌다.

#### `일시적 리다이렉션`

사용자가 요청한 리소스는 명시된 URL이 아닌 다른 URL로부터 전송될 수 있다. 이런 경우에, 일시적 리다이렉션을 쓴다.

일시적 리다이렉션은 리소스를 생성, 업데이트, 삭제할 때 사용 가능하다.

|코드|텍스트|메서드|주로 사용되는 곳|
|---|---|---|---|
|302|`Found`|`GET` 메서드는 변경되지 않는다. 다른 메서드들은 `GET`으로 변할 수도 있다.|예측하지 못한 이유로 웹 페이지가 일시적으로 작동하지 않을 때가 있다.|
|303|`See Other`|`GET` 메서드는 변경되지 않는다. 다른 메서드들은 `GET`으로 변할 수도 있다.|페이지 새로고침을 막기 위해 `PUT` 혹은 `POST` 뒤에 사용한다.|
|307|`Temporary Redirect`|메소드와 본문은 변하지 않음.|예측하지 못한 이유로 웹 페이지가 일시적으로 작동하지 않을 때가 있다. GET이 아닌 메서드가 사이트에서 이용 가능할 때 `302`보다 좋다.|

#### `특수한 리다이렉션`

앞에서 언급한 두 개의 리다이렉션과는 다르게 특별한 두 가지 리다이렉션이 있다.

`304`는 로컬에 캐시된 복사본으로 페이지를 리다이렉트시키며, `300`(다중 선택)은 수동 리다이렉션이다. 


|코드|텍스트|주로 사용되는 곳|
|---|---|---|
|300|`Multiple Choice`|드물게 발생한다. 본문의 HTML 페이지 내에 선택지가 나열된다.|
|304|`Not Modified`|캐시 리프레시: 캐시 값이 여전히 사용 가능함을 나타낸다.|

---

### Redirection을 할 수 있는 그 외 방법들

HTTP 리다이렉션 외에도 리다이렉션을 할 수 있는 두 개의 다른 방법이 존재한다. 

HTML 리다이렉션과 Javascript 리다이렉션이다.

#### `HTML 리다이렉션`

HTTP 리다이렉션은 권장되지는 않으나 개발자가 서버에 대한 접근이 불가할 때, `refresh`를 설정하기 위해 `<head>` 내에 `<meta>` 엘리먼트와 `http-equiv` 속성으로 HTML 페이지를 만들 수 있다.

해당 `<meta>`가 포함된 페이지를 불러오면, 브라우저는 엘리먼트를 발견하고 명시된 페이지로 이동한다.

```
<head> 
  <meta http-equiv="Refresh" content="0; URL=https://example.com/">
</head>
```

`content` 속성은 주어진 URL로 리다이렉트 하기 전에 브라우저가 얼마만큼의 시간을 기다려야하는지 명시하는 숫자로 시작한다.

기본적으로는 0을 설정하는 것이 좋다.

해당 메서드는 오로지 HTML 페이지에서만 작동한다.

#### `Javascript 리다이렉션`

자바스크립트 내에서의 리다이렉션은 `window.location` 프로퍼티에 값을 설정해서 만들어진다.

``` javascript
window.location = "https://example.com/";
```

자바스크립트를 실행한 클라이언트 상에서만 동작하지만 어떤 조건이 충적되는 경우에만 리다이렉션을 작동시킬 수 있다는 점에서 HTML 리다이렉션에 비해 더 많은 활용성을 가진다.

#### `우선 순위`

리다이렉션을 하는 3가지 방법의 우선 순위는 다음과 같다.

1. 페이지가 읽힌 적도 없고 전송된 적도 없을 경우, HTTP 리다이렉션 실행
2. 어떤 HTTP 리다이렉트도 없는 경우에 HTML 리다이렉트 (`<HTML>`) 실행
3. 자바스크립트 리다이렉트는 최후의 수단으로 사용되며, 클라이언트 측에서 자바스크립트를 활성시킨 경우메나 사용할 수 있다.

가능하면 항상 HTTP 리다이렉션을 사용하는 것이 좋다.

---

참조 : <br> 
* https://developer.mozilla.org/en-US/docs/Web/HTTP/Redirections
